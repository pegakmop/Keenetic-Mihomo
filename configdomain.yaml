mixed-port: 7897
socks-port: 7890 # SOCKS5 proxy port (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ SOCKS5 –ø—Ä–æ–∫—Å–∏)
tproxy-port: 4000
allow-lan: true
mode: rule
log-level: silent
find-process-mode: off
ipv6: false
tcp-concurrent: true # –Ω–µ—Å–∫–æ–ª—å–∫–æ TCP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
keep-alive-interval: 30
profile:
  store-selected: true
external-controller: '0.0.0.0:9090' # –∞–¥—Ä–µ—Å –≤–µ–± –∞–¥–º–∏–Ω–∫–∏: http://192.168.1.1:9090/ui
external-ui: ui
external-ui-url: "https://github.com/Zephyruso/zashboard/releases/latest/download/dist.zip"

sniffer:
  enable: true
  parse-pure-ip: true
  force-dns-mapping: true
  sniff:
    HTTP:
      ports: [80]
    TLS:
      ports: [443]
    QUIC:
      ports: [443]
dns:
  enable: true
  cache-algorithm: arc
  rebind-protection:
    enabled: true
  prefer-h3: true
  use-hosts: false
  use-system-hosts: false
  listen: 0.0.0.0:53
  ipv6: false
  strict-mode: false # –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å DNS
  enhanced-mode: redir-host
  default-nameserver:
  - 1.1.1.1 # Cloudflare Public DNS (UDP/TCP)
  - 1.0.0.1 # Cloudflare Public DNS (UDP/TCP)
  - 8.8.8.8 # Google Public DNS (UDP/TCP)
  - 9.9.9.9 # Quad9 Public DNS (UDP/TCP)
  proxy-server-nameserver:
    - https://cloudflare-dns.com/dns-query
    - tls://1.1.1.1
    - tls://1.0.0.1
    - tls://8.8.8.8
    - tls://8.8.4.4
    - tls://9.9.9.9
    - https://8.8.8.8/dns-query
    - https://9.9.9.9/dns-query
  direct-nameserver:
  - 77.88.8.8 # –Ø–Ω–¥–µ–∫—Å.DNS (UDP/TCP) - –æ—Å–Ω–æ–≤–Ω–æ–π
  - 213.180.204.213 # –Ø–Ω–¥–µ–∫—Å.DNS (UDP/TCP) - —Ä–µ–∑–µ—Ä–≤–Ω—ã–π
  nameserver:
  - https://cloudflare-dns.com/dns-query#PROXY
  - tls://dns.cloudflare.com # DoT Cloudflare
  - https://dns.google/dns-query # DoH Google
  nameserver-policy:
    rule-set:tmdb: 9.9.9.9
    rule-set:youtube:
    - 1.1.1.1
    - 1.0.0.1
    rule-set:ru-bundle:
    - https://cloudflare-dns.com/dns-query
    - tls://dns.cloudflare.com
    - https://dns.google/dns-query # DoH Google
    +.ru:
    - 77.88.8.8
    - 213.180.204.213
    +.su:
    - 77.88.8.8
    - 213.180.204.213
    +.by:
    - 77.88.8.8
    - 213.180.204.213
    rule-set:geosite-ru:
    - 77.88.8.8
    - 213.180.204.213
    DIRECT:
    - direct-nameserver
    MATCH:
    - proxy-server-nameserver

# –ü—Ä–∏–º–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–æ–¥–ø–∏—Å–∫–∏
# --- –í–ê–®–ò –ü–†–û–ö–°–ò-–°–ï–†–í–ï–†–´ ---
proxy-providers:
  proxy_sub:
    type: http
    url: https://—Ç—É—Ç–≤–∞—à–∞—Å—Å—ã–ª–∫–∞–Ω–∞–ø–æ–¥–ø–∏—Å–∫—É–∫–ª–µ—à–∏–ª–∏–º–∏—Ö–æ–º–æ # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Å–≤–æ—é —Å—Å—ã–ª–∫—É –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –ø—Ä–æ–∫—Å–∏ (–í–ü–ù)
    path: ./proxy-providers/proxy_sub.yml
    interval: 43200
    explicit: true
    health-check:
      enable: true
      url: http://cp.cloudflare.com/
      interval: 300
      timeout: 2000
      lazy: false
      expected-status: 204
    override:
      udp: true
      tfo: true

proxy-groups:
  - name: üåç VPN –±–µ–∑ RU
    icon: https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Hijacking.png
    type: select
    proxies:
      - ‚ö°Ô∏è –°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π
      - üì∂ –ü–µ—Ä–≤—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π
      - üîì –ë–µ–∑ VPN
    include-all: true
  - name: ‚ñ∂Ô∏è YouTube
    icon: https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/YouTube.png
    type: select
    exclude-filter: –ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã
    proxies:
      - ‚ö°Ô∏è –°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π
      - üì∂ –ü–µ—Ä–≤—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π
      - üîì –ë–µ–∑ VPN
    include-all: true
  - name: üì∫ TikTok # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–ª—å–∫–æ Tiktok,  –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É —Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º –ø–∏–Ω–≥–æ–º
    icon: https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/TikTok_1.png
    type: select
    proxies:
      - ‚ö°Ô∏è –°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π
      - üì∂ –ü–µ—Ä–≤—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π
      - üîì –ë–µ–∑ VPN
    include-all: true
  - name: ü§ñ OPENAI
    icon: https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/ChatGPT.png
    type: select
    proxies:
      - ‚ö°Ô∏è –°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π
      - üì∂ –ü–µ—Ä–≤—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π
    include-all: true
  - name: üè† RU —Å–∞–π—Ç—ã
    icon: https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Russia.png
    type: select
    proxies:
      - üîì –ë–µ–∑ VPN
      - ‚ö°Ô∏è –°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π
    include-all: true
  - name: üè≥Ô∏è Other sites
    hidden: false
    type: select
    proxies:
      - üè† RU —Å–∞–π—Ç—ã
      - üåç VPN –±–µ–∑ RU
  - name: PROXY
    type: select
    hidden: true
    proxies:
      - üåç VPN –±–µ–∑ RU
    include-all: true
  - name: üîì –ë–µ–∑ VPN
    type: select
    hidden: true
    proxies:
      - DIRECT
  - name: ‚ö°Ô∏è –°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π
    hidden: true
    type: url-test
    tolerance: 150
    url: https://www.gstatic.com/generate_204
    interval: 300
    proxies:
    exclude-filter: "WARP"
    include-all: true
  - name: üì∂ –ü–µ—Ä–≤—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π
    hidden: true
    icon: https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Download.png
    type: fallback
    url: https://www.gstatic.com/generate_204
    interval: 300
    proxies:
    exclude-filter: "WARP"
    include-all: true
  - name: ‚òÅÔ∏è Cloudflare
    type: select
    icon: https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Cloudflare.png
    hidden: false
    proxies:
      - ‚ö°Ô∏è –°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π
      - üì∂ –ü–µ—Ä–≤—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π
      - üîì –ë–µ–∑ VPN
    include-all: true

rule-providers:
  ru-inline-banned:
    type: inline
    payload:
      - DOMAIN-SUFFIX,habr.com
      - DOMAIN-KEYWORD,4pda
      - DOMAIN-SUFFIX,kemono.su
      - DOMAIN-SUFFIX,jut.su
      - DOMAIN-SUFFIX,kara.su
      - DOMAIN-SUFFIX,theins.ru
      - DOMAIN-SUFFIX,tvrain.ru
      - DOMAIN-SUFFIX,echo.msk.ru
      - DOMAIN-SUFFIX,the-village.ru
      - DOMAIN-SUFFIX,snob.ru
      - DOMAIN-SUFFIX,novayagazeta.ru
      - DOMAIN-SUFFIX,moscowtimes.ru
      - DOMAIN-KEYWORD,animego
      - DOMAIN-KEYWORD,yummyanime
      - DOMAIN-KEYWORD,yummy-anime
      - DOMAIN-KEYWORD,animeportal
      - DOMAIN-KEYWORD,anime-portal
      - DOMAIN-KEYWORD,animedub
      - DOMAIN-KEYWORD,anidub
      - DOMAIN-KEYWORD,animelib
      - DOMAIN-KEYWORD,ikianime
      - DOMAIN-KEYWORD,anilibria
    behavior: classical
  ru-inline:
    type: inline
    payload:
      - DOMAIN-SUFFIX,2ip.ru
      - DOMAIN-SUFFIX,yastatic.net
      - DOMAIN-SUFFIX,yandex.net
      - DOMAIN-SUFFIX,yandex.kz
      - DOMAIN-SUFFIX,yandex.com
      - DOMAIN-SUFFIX,mycdn.me
      - DOMAIN-SUFFIX,vk.com
      - DOMAIN-SUFFIX,.ru
      - DOMAIN-SUFFIX,.su
      - DOMAIN-SUFFIX,.by
      - DOMAIN-SUFFIX,.ru.com
      - DOMAIN-SUFFIX,.ru.net
      - DOMAIN-SUFFIX,kudago.com
      - DOMAIN-SUFFIX,kinescope.io
      - DOMAIN-SUFFIX,redheadsound.studio
      - DOMAIN-SUFFIX,plplayer.online
      - DOMAIN-SUFFIX,lomont.site
      - DOMAIN-SUFFIX,remanga.org
      - DOMAIN-SUFFIX,shopstory.live
      - DOMAIN-SUFFIX,smallpdf.com
      - DOMAIN-KEYWORD,miradres
      - DOMAIN-KEYWORD,premier
      - DOMAIN-KEYWORD,shutterstock
      - DOMAIN-KEYWORD,2gis
      - DOMAIN-KEYWORD,diginetica
      - DOMAIN-KEYWORD,kinescopecdn
      - DOMAIN-KEYWORD,researchgate
      - DOMAIN-KEYWORD,springer
      - DOMAIN-KEYWORD,nextcloud
      - DOMAIN-KEYWORD,kaspersky
      - DOMAIN-KEYWORD,stepik
      - DOMAIN-KEYWORD,likee
      - DOMAIN-KEYWORD,snapchat
      - DOMAIN-KEYWORD,yappy
      - DOMAIN-KEYWORD,pikabu
      - DOMAIN-KEYWORD,okko
      - DOMAIN-KEYWORD,wink
      - DOMAIN-KEYWORD,kion
      - DOMAIN-KEYWORD,roblox
      - DOMAIN-KEYWORD,ozon
      - DOMAIN-KEYWORD,wildberries
      - DOMAIN-KEYWORD,aliexpress
    behavior: classical
  geosite-ru:
    type: http
    behavior: domain
    format: mrs
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/meta/geo/geosite/category-ru.mrs
    path: ./provider/rule-set/geosite-ru.mrs
    interval: 604800
  drweb:
    type: http
    behavior: domain
    format: mrs
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/meta/geo/geosite/drweb.mrs
    path: ./provider/rule-set/drweb.mrs
    interval: 604800
  geoip-ru:
    type: http
    behavior: ipcidr
    format: mrs
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/meta/geo/geoip/ru.mrs
    path: ./provider/rule-set/geoip-ru.mrs
    interval: 604800
  geoip-by:
    type: http
    behavior: ipcidr
    format: mrs
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/meta/geo/geoip/by.mrs
    path: ./provider/rule-set/geoip-by.mrs
    interval: 604800
  geosite-private:
    type: http
    behavior: domain
    format: mrs
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/meta/geo/geosite/private.mrs
    path: ./provider/rule-set/geosite-private.mrs
    interval: 604800
  geoip-private:
    type: http
    behavior: ipcidr
    format: mrs
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/meta/geo/geoip/private.mrs
    path: ./provider/rule-set/geoip-private.mrs
    interval: 604800
  discord_domains:
    type: http
    behavior: domain
    format: mrs
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/meta/geo/geosite/discord.mrs
    path: ./provider/rule-set/discord_domains.mrs
    interval: 604800
  discord_vc:
    type: inline
    payload:
      - AND,((IP-CIDR,138.128.136.0/21),(NETWORK,udp),(DST-PORT,50000-51000))
      - AND,((IP-CIDR,162.158.0.0/15),(NETWORK,udp),(DST-PORT,50000-51000))
      - AND,((IP-CIDR,172.64.0.0/13),(NETWORK,udp),(DST-PORT,50000-51000))
      - AND,((IP-CIDR,34.0.0.0/15),(NETWORK,udp),(DST-PORT,50000-51000))
      - AND,((IP-CIDR,34.2.0.0/15),(NETWORK,udp),(DST-PORT,50000-51000))
      - AND,((IP-CIDR,35.192.0.0/12),(NETWORK,udp),(DST-PORT,50000-51000))
      - AND,((IP-CIDR,35.208.0.0/12),(NETWORK,udp),(DST-PORT,50000-51000))
      - AND,((IP-CIDR,5.200.14.128/25),(NETWORK,udp),(DST-PORT,50000-51000))
      - AND,((IP-CIDR,66.22.192.0/18),(NETWORK,udp),(DST-PORT,50000-51000))
    behavior: classical
  refilter_domains:
    type: inline
    behavior: domain
    format: mrs
    url: https://github.com/legiz-ru/mihomo-rule-sets/raw/main/re-filter/domain-rule.mrs
    path: ./provider/rule-set/domain-rule.mrs
    interval: 604800
  refilter_ipsum:
    type: http
    behavior: ipcidr
    format: mrs
    url: https://github.com/legiz-ru/mihomo-rule-sets/raw/main/re-filter/ip-rule.mrs
    path: ./provider/rule-set/ip-rule.mrs
    interval: 604800
  youtube:
    type: http
    behavior: domain
    format: mrs
    interval: 604800
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/meta/geo/geosite/youtube.mrs
    path: ./provider/rule-set/youtube.mrs
  oisd_big:
    type: http
    behavior: domain
    format: mrs
    url: https://github.com/legiz-ru/mihomo-rule-sets/raw/main/oisd/big.mrs
    path: ./provider/rule-set/oisd/big.mrs
    interval: 604800
  torrent-trackers:
    type: http
    behavior: domain
    format: mrs
    url: https://github.com/legiz-ru/mihomo-rule-sets/raw/main/other/torrent-trackers.mrs
    path: ./provider/rule-set/torrent-trackers.mrs
    interval: 604800
  torrent-clients:
    type: http
    behavior: classical
    format: yaml
    url: https://github.com/legiz-ru/mihomo-rule-sets/raw/main/other/torrent-clients.yaml
    path: ./provider/rule-set/torrent-clients.yaml
    interval: 604800
  ru-bundle:
    type: http
    behavior: domain
    format: mrs
    url: https://github.com/legiz-ru/mihomo-rule-sets/raw/main/ru-bundle/rule.mrs
    path: ./provider/rule-set/ru-bundle/rule.mrs
    interval: 604800
  full-vpn:
    type: inline
    behavior: classical
    payload:
      - NETWORK,tcp
      - NETWORK,udp
  openai:
    type: http
    behavior: domain
    format: mrs
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/meta/geo/geosite/openai.mrs
    path: ./provider/rule-set/openai.mrs
    interval: 604800
  gemini:
    type: http
    behavior: domain
    format: mrs
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/meta/geo/geosite/google-gemini.mrs
    path: ./provider/rule-set/gemini.mrs
    interval: 604800
  ai-bundle:
    type: http
    behavior: domain
    format: mrs
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/meta/geo/geosite/category-ai-!cn.mrs
    path: ./provider/rule-set/geo/geosite/category-ai-!cn.mrs
    interval: 604800
  cloudflare:
    type: http
    behavior: ipcidr
    format: mrs
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/meta/geo/geoip/cloudflare.mrs
    path: ./provider/rule-set/cloudflare.mrs
    interval: 604800
  speedtest:
    type: http
    behavior: domain
    format: mrs
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/meta/geo/geosite/speedtest.mrs
    path: ./provider/rule-set/speedtest.mrs
    interval: 604800
  apple:
    type: http
    behavior: domain
    format: mrs
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/meta/geo/geosite/apple.mrs
    path: ./provider/rule-set/apple.mrs
    interval: 604800
  tiktok:
    type: http
    behavior: domain
    format: mrs
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/meta/geo/geosite/tiktok.mrs
    path: ./provider/rule-set/tiktok.mrs
    interval: 604800
  google:
    type: http
    behavior: domain
    format: mrs
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/meta/geo/geosite/google.mrs
    path: ./provider/rule-set/google.mrs
    interval: 604800
  tmdb:
    type: http
    behavior: domain
    format: mrs
    url: https://github.com/MetaCubeX/meta-rules-dat/raw/meta/geo/geosite/tmdb.mrs
    path: ./provider/rule-set/tmdb.mrs
    interval: 604800
rules:
  - RULE-SET,geosite-private,DIRECT,no-resolve
  - RULE-SET,geoip-private,DIRECT
#  - AND,((NETWORK,udp),(DST-PORT,443)),REJECT
#  - AND,((NETWORK,udp),(DST-PORT,853)),REJECT
  - RULE-SET,oisd_big,REJECT
  - RULE-SET,speedtest,DIRECT
  - OR,((RULE-SET,torrent-clients),(RULE-SET,torrent-trackers)),DIRECT
  - OR,((DOMAIN,ipwho.is),(DOMAIN,api.ip.sb),(DOMAIN,ipapi.co),(DOMAIN,ipinfo.io),(DOMAIN-SUFFIX,2ip.io),(DOMAIN-SUFFIX,2ipcore.com)),üåç VPN –±–µ–∑ RU
  - OR,((RULE-SET,discord_domains),(RULE-SET,discord_vc)),üåç VPN –±–µ–∑ RU
  - RULE-SET,ru-inline,üè† RU —Å–∞–π—Ç—ã
  - RULE-SET,apple,üè† RU —Å–∞–π—Ç—ã
  - RULE-SET,youtube,‚ñ∂Ô∏è YouTube
  - RULE-SET,tiktok,üì∫ TikTok
  - RULE-SET,ai-bundle,ü§ñ OPENAI
  - RULE-SET,google,üè† RU —Å–∞–π—Ç—ã
  - RULE-SET,cloudflare,‚òÅÔ∏è Cloudflare
  - RULE-SET,ru-bundle,üåç VPN –±–µ–∑ RU
  - RULE-SET,refilter_domains,üåç VPN –±–µ–∑ RU
  - RULE-SET,refilter_ipsum,üåç VPN –±–µ–∑ RU
  - RULE-SET,ru-inline-banned,üåç VPN –±–µ–∑ RU
  - RULE-SET,geosite-ru,üè† RU —Å–∞–π—Ç—ã
  - RULE-SET,geoip-ru,üè† RU —Å–∞–π—Ç—ã
  - RULE-SET,geoip-by,üè† RU —Å–∞–π—Ç—ã
  - RULE-SET,drweb,üè† RU —Å–∞–π—Ç—ã
  - RULE-SET,full-vpn,üè≥Ô∏è Other sites
  - MATCH,üåç VPN –±–µ–∑ RU
